= Read me

The generated doctree is at
https://bootstrapworld.github.io/curriculum.

== Building

The top directory contains the subdirectories `lessons`,
`pathways`, which between them contain the curriculum content.
Explore them to see where things are.

  build-pathway
  /lib/asciidoctor.css
       shared.css
       adoc-preproc.rkt
       copy-lessons.rkt
       form-elements.rkt
       function-directives.rkt
       make-workbook.rkt
  /shared
    /langs/en-us/curriculum.css
                 BSABigIdeas.pdf
                 front-cover-teacher.pdf
                 defines.rkt
                 glossary-terms.rkt
                 standards-dictionary.rkt
                 curriculum.css
  /lessons
    /lessonX/langs/en-us/index.adoc
                         exercises/recipe.adoc
                         images/picture.jpg
                         workbook-pages/lesson-index.rkt
                         workbook-pages/page1.adoc
                         workbook-pages/page2.pdf
                         workbook-pages/pyret/page2.pdf
                         workbook-sols-pages/page2.pdf
                         workbook-sols-pages/pyret/page2.pdf

  /pathways
    /pathwayX/langs/en-us/index.adoc
                          workbook-index.rkt
                          external-index.rkt
                          resources/index.adoc

In particular, “lesson A” is in subdirectory `lessonA` inside
`lessons`. The lesson plan is the `index.adoc` file in
`lessons/lessonA/langs/en-us`.

(As a convenience, the lesson plan `.adoc` file can be
named anything, e.g., `jened.adoc`. If there are multiple
`.adoc` files, it is not reliably known which of them will be the
lesson plan. However, a file `index.adoc`, if it exists, will
definitely be the lesson plan.)

The exercises associated with lesson A are alongside the lesson
plan adoc file, in subdirectory `exercises`. Images are in
subdir `images`. Single workpages are in subdir `workbook-pages`
(some of these can be static PDFs). The index of these lesson
pages, in correct order, is in `lesson-index.rkt`. By default,
these pages are rendered in portrait mode. If you desire a
particular file `file.adoc` to be in landscape, its entry in
`lesson-index.rkt` should be `("file.adoc" "landscape")`. (The
entry `"file.adoc"` is convenient shorthand for `("file.adoc"
"portrait")`.)  (The strings `"landscape"` and `"portrait"` may
be in any case.)

Lesson pages are paginated by default when they show up in the
workbook. If you don’t want a page to be populated, its entry in
`lesson-index.rkt` should be `("file.adoc" "portrait"
"nopagenum")`. (The aspect should also be mentioned, even if it’s
the default.)

The subdir `workbook-sols-pages` contains workpages that would
replace corresponding pages in the `workbook-pages` directory
when creating the teacher version of the lesson pages. They use
the same filename as the “student” pages they replace. Only pages
that differ between the two versions need be supplied.

The subdirs `pyret` in the `workbook-pages` and
`workbook-sols-pages` contain workpages that would replace
corresponding pages when creating versions for the option
`--proglang pyret` (see below).

There are three pathways in the repo for now:

  pathways/pathwayP
  pathways/bs-flags-pathway
  pathways/bs-game-pathway

In a pathway’s directory, the pathway narrative is in
`langs/en-us/index.adoc`.
Alongside it, its
index of lessons, in correct order, is in `workbook-index.rkt`.
These lessons are drawn from the `lessons`
tree.

(As a convenience, the pathway narrative `.adoc` file can be
named anything, e.g., `narrative.adoc`. If there are multiple
`.adoc` files, it is not reliably known which of them will be the
narrative. However, a file `index.adoc`, if it exists, will
definitely be the narrative.)

The pathway directory contains a subdirectory `resources`, where
`index.adoc` is the source for the Teacher Resouces page.

(As a convenience, the teacher resources `.adoc` file can be
named anything, e.g., `teacher-resources.adoc`. If there are multiple
`.adoc` files, it is not reliably known which of them will be the
teacher resources page. However, a file `index.adoc`, if it exists, will
definitely be chosen for the teacher resources page.)

The top dir contains the script `build-pathway`. It takes any
number of pathway arguments, an optional `--language`
argument, and an optional `--proglang` argument.

For each of the pathway args, it creates a document tree under
the `distribution` directory. A pathway arg can be either the
pathway name, or its relative pathname from the `build-pathway`
script, with or without a trailing slash, e.g., `pathwayP`, or
`pathways/pathwayP`, or `pathways/pathwayP/`.

If no pathway arg is supplied,
`build-pathway` generates doctrees for every pathway in
`pathways`.

If no `--language` option is supplied, the prose language used is
`en-us`. To specify another language, say `es-mx`, use
`--language es-mx`.

The doctree for the built pathway under `distribution` resides
under a subdirectory named for the prose language, e.g., `en-us`.

   distribution/
     pathwayX/en-us/index.html
                    pathway-lessons.html
                    lessons/
                           index.html
                           exercises/*.{html,pdf}
                           workbook-pages/*.{html.pdf}
                    resources/
                       index.html
                       protected/
                          workbook-sols.pdf
                    workbook/workbook.pdf

If no `--proglang` option is supplied to `build-pathway`, the programming language
used is `pyret`. To specify another language, say `wescheme`, use
`--language wescheme`. The distribution doctree for a language
other than `pyret` is named with that language as a hyphenated
suffix, e.g., `pathwayP-wescheme`.

The general run of pathways are written for `pyret`. However, for
now, the pathways named `bs-game-pathway` and `algebra` are
written for both `pyret` and `wescheme`, and `wescheme` version
is equally or more important than the `pyret version. Such pathways always use
the language suffix for better disambiguation. Thus,
`algebra-wescheme` coexists with `algebra-pyret`.
(This special case may be removed in future
releases.)

Note that two workbook PDFs can be created, one for the students
in the `workbook` directory; and another for teachers in the
“protected” directory `resources/protected`.

The pathway narrative web page `index.html` includes a link to
`pathway-lessons.html`, which contains all the lesson plans
associated with the pathway. It also points to the student
workbook PDF. (The teacher, or solutions, workbook, can be
referred to in the teacher resources page with the directive
`@solutions-workbook`.)

As a convenience, a `git push` into the `master` branch
automatically triggers a build of all the pathways
and showcases the resulting doctrees on the website
https://bootstrapworld.github.io/curriculum.

== Deploying to the Bootstrap website

If you've cloned the https://github.com/bootstrapworld/curriculum
repo anywhere on the machine hosting the Bootstrap website, then
calling the script `bootstrap-site-deploy` inside that clone
updates the documents displayed on the site. (It does this by
bringing over the `gh-pages` branch, which contains the latest
converted files as shown on the `github.io`
site mentioned above.)

== Sample lesson plan

The following was reverse-engineered from the latest Google Docs
mock-up of a lesson from Jen/Ed. Change this to reflect
experience.

link:distribution/pathwayP/en-us/lessons/lessonA/index.html[Sample
lesson plan]

== Git basics

Fork this repo to your GitHub account (say, `jrandomuser`). (This is done using
obvious buttons on the GitHub page.)

In your terminal, clone your fork thusly:

   git clone https://github.com/jrandomuser/curriculum

This will create a local repo where you can try things, change
things, etc. But first, to retain connection with the original do:

  git remote add upstream https://github.com/bootstrapworld/curriculum

Every time the original changes, update like so:

  git fetch upstream
  git merge upstream/master

You are probably in your own `master` branch. Even if you’re
“branching out” to other new branches, the above merge will
mostly work.  “Mostly” because merge often triggers conflicts
depending on how far you have diverged from the original. At the
very least, make sure you’ve checked in all your changes that you
care about, before you attempt a merge. For changes you aren’t
ready to check in, save the concerned files somewhere else, and
make sure there are no “modified” files in your directory.

=== Creating your private branch in the original repo

Alternatively -- and this will work only for greenlisted members
-- clone the repo directly and add your own branch, e.g.,

  git clone https://github.com/bootstrapworld/curriculum
  cd curriculum
  git checkout -b jenbranch

You can pull and merge from `master` as needed:

  git checkout master
  git pull
  git checkout jenbranch
  git merge master

If conflicts arise, you will be given a way to resolve them.

=== To make your fetch/merge experience easier

The directory `distribution` contains generated files which can
always be re-generated. Before you merge, delete its contents and re-create
its default so the merge doesn't get snagged in it:

  cd distribution
  rm -fr *
  git checkout -- \*

Create your own lesson directories under `lessons` and your own
pathways under `pathways`.  Work exclusively there, rather than
the supplied lessons `lessonA`, `lessonB`, `lessonC` and supplied
pathway `pathwayP` -- which are there purely for illustration.
As the original repo doesn't know about your lessons and
pathways, there will be no conflicts from that regard.

NB: When you create a pathway, named `pathwayQ` say, use

  `./build-pathway pathwayQ`

to generate its files. Without an argument, `build-pathway` uses
`bs-flags-pathway`.

== Glossary and standards

Glossary items are annotated with the directive `@vocab`. E.g.,

  @vocab{function}

Standards are annotated with `@std`. E.g.,

  @std{2-AP-10 , 3A-NI-06 , N-Q&1&2, N-Q&1&3}

Such items are searched in
`shared/langs/en-us/{glossary-terms.rkt,standards-dictionary.rkt}`,
and are inserted as lists at the head of the document. In
addition, glossary items for a set of files in a directory are
collected into a file `summary.html`.

== Exercises

Exercise files are typically recipes and have calls to one of two
directives

  @design-recipe-exercise{...}

  @assess-design-recipe{...}

The former is used to specify a correct recipe; the latter to
introduce a recipe to be debugged. See examples of such files,
`exercise*.adoc`, in the repo.

== Cross-references and pagination

Both lesson plans and pathway narratives can refer to any files
in any lessons, in particular, exercises
or specific
pages in a pathway workbook.  The relevant directive
calls look like

  @worksheet-link{lessonA/exercises/exerciseA1.html, link-text}
  @worksheet-link{lessonA/workbook-pages/pageA2.pdf, link-text}

The final argument for link text is optional.

If called from a lesson plan for `lessonA`, the `lessonA/` may be
dropped. Thus the first two examples can be rewritten:

  @worksheet-link{exercises/exerciseA1.html, link-text}
  @worksheet-link{workpage-pages/pageA2.pdf, link-text}

Arbitrary pages can be invoked:

  @worksheet-link{lessonA/jened.adoc, link-text}

This refers to `jened.adoc` in `lessonA`. Typically pages within
the same lesson’s directory are used, in which case the `lessonA`
may be replaced by a `.`:

  @worksheet-link{./jened.adoc, link-text}

Subdirectories can also be used:

  @worksheet-link{./resources/jened.adoc, link-text}

For pages known to be workbook pages, the rendered link has its
link text (if any) augmented with a reference to the specific
page number in the pathway worksheet.

A workbook page can include an exercise in the same lesson using

  @worksheet-include{exercises/exerciseA1.adoc}

(It does not make sense to use `@worksheet-link` as workbooks are
standalone PDFs that are typically printed, and any links in it
would not be reachable anyway.)

Use @image{images/pic.png} to insert the image `pic.png`.

Use commas to add image options, e.g.,

  @image{images/player-move.png, PlayerMovement, 400, align="center"}

=== Generic links

Use `@link{URL, link-text}` to refer to a generic URL
not part of the curriculum hierarchy.  The second argument for
the link text is optional.

==== Generic links with standard names

Use `@worksheet-link{pointer, link-text}` to refer to a pointer
(a standard name) to a possibly volatile URL. E.g.,

  @worksheet-link{demo-page, The Demo Page}

The pointer `demo-page` is resolved using an index file
`external-index.rkt`, which contains an assoc list, with entries
like

  ("demo-page"
       "https://bootstrapworld.github.io/curriculum/index.html")

==== Programming language specific text

Use the conditional with the attribute `proglang` to selectively
render portions of the document for a specific programming
language. E.g.,

```
  ifeval::["{proglang}" == "pyret"]
  This text occurs in the Pyret-specific portion of the
  document.
  endif::[]
```

== Some useful classes and directives

Some standard CSS classes to emphasize certain regions of text.

Use

  [.strategy-box]
  .Header
  ****
  Rem suscipit soluta quas recusandae dolor culpa non. Iste aut
  ipsum qui eos quidem et. Debitis omnis ipsam cupiditate ut vero
  odio.
  ****

to generate a “strategy box”, a boxed text with a blue border.

Use

   [.notice-box]

to generate a “notice & wonder box”, a boxed text with a purple
border.

Add the class `.physics-table` to a table attribute to generate a
single-arg function
table, e.g., one that maps miles driven to cost.

Use

   @lesson-description{... text ...}

to identify text describing a lesson plan. This is displayed both
in-place and in the autogenerated link to the lesson plan in the
pathway narrative.

== Prereqs

Needed:

* Asciidoctor, a Ruby program, to generate HTML from AsciiDoc.
(The format is AsciiDoc, the program that converts it is
Asciidoctor. I wish we had this neat nomenclatural separation for
other programs too.) To install it,
+
  sudo apt-get install asciidoctor
+
on Linux machines, and
+
  brew install asciidoctor
+
on macOS.
+

* Racket, to do preprocessing for metadata and other
bookkeeping. Any version should do. I’m using very conservative
Racket.

* PDF manipulators `wktohtmltopdf` and `pdftk`.  Standard
installation as for Asciidoctor.

* TeX containing `pdflatex`. Install a suitable TeX system for
your OS (for Linux, it’s `texlive`).

=== A brief AsciiDoc intro

An AsciiDoc source file typically as the extension `.adoc`, at
least in our setup.

A title (aka “level 1”) header has its line preceded by a single
equal sign.

Level 2 headers (“sections”) are preceded by two equal signs.
Similarly for “subsections” at level 3, 4, 5, 6.

  = Title at level 1

  == Section at level 2

  === Subsection at level 3

  ==== Et cetera

Itemized lists have each item paragraph preceded by a ``*`` or
``-`` and space.

Emphasized text is set within by +_..._+.

Bold text within +*...*+.

In-text code fragment within +`...`+.

Code displays are on contiguous lines that are indented (amount
of indentation doesn't matter as long it's non-0).

Please see the
https://asciidoctor.org/docs/user-manual[Asciidoctor manual] for
the whole story. Learn just the bare minimum to get started writing,
and then learn more as needed, either from the online manual, or by bugging
me. (If something seems too tedious to learn or input, I could
add it as a Racket directive.)

If your Asciidoctor version is at least 2.0.0, you can type

  asciidoctor --help syntax

to get a brief reference guide to the syntax. To create a browsable HTML
file, do

  asciidoctor --help syntax | asciidoctor - -o help.html

and open `help.html` in your browser.

// trivial line to trigger travis
