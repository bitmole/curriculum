= Defining Functions

@lesson-description{Students discover functions as an abstraction over a programming pattern, and are introduced to a structured approach to building them called the Design Recipe.}

[@lesson-intro-table]
|===
@prereqs-stds{alg-defining-values}

| Lesson Goals
| Students will be able to:

* describe the usefulness of @vocab{functions}.
* create their own functions and @vocab{examples} given the constraints of a problem.
* define one-argument functions that consume a Number and produce an Image
* define one-argument functions that consume a String and produce an Image
* define one-argument functions that consume a Row and produce an Image


| Student-Facing Lesson Goals
|
* I can explain why a function is useful.
* I can write my own function in @ifproglang{wescheme}{WeScheme} @ifproglang{pyret}{Pyret}.

| Materials
|[.materials-links]

@ifproglang{wescheme}{
* @link{https://docs.google.com/presentation/d/11MWx9P1NZDRrZHh5y3CDRflLOX0nLgeilrpvih4eJFg/, Lesson Slides}
}
@ifproglang{pyret}{
* @link{https://docs.google.com/presentation/d/1UzwpEWzq01UDedMAyNhgFKaQ3_z96CB9iLIWQUt7BzI/, Lesson Slides}
}

@material-links

| Preparation
|
* Make sure all materials have been gathered
* Decide how students will be grouped in pairs


| Key Points for the Facilitator
|
* This lesson represents a _big_ shift in thinking.  After some practice, students will not be limited to pre-existing functions!
* Take plenty of time for the @vocab{Design Recipe} as students will return to it frequently in future lessons.

@lang-prereq

|===

[.old-materials]
Click here to see the @link{https://www.bootstrapworld.org/materials/spring2020/courses/algebra/en-us/units/unit4/index.html, prior unit-based version}

== Identifying Repeated _Patterns_ @duration{15 minutes}

=== Overview
Students have already searched for structure in a list of expressions in order to define values. Now, they'll search for structures that are _dynamic_, meaning they change in a predictable way. This is the foundation for defining functions.

=== Launch

Students should have their workbook, pencil, and be logged into
@ifproglang{wescheme}{ @link{https://www.wescheme.org, WeScheme     } }
@ifproglang{pyret}{    @link{https://code.pyret.org, code.pyret.org } }
on their computer.

@centered-image{images/ILoveGreenTriangles.jpg, I Love Green Triangles, 400, align="center"}

@centered-image{images/GreenTriangle.jpg, I Love Green Triangles, 400, align="center"}

This is a fun lesson to make silly! Dramatically confess to your students, "I LOVE green triangles!" Challenge them to use the Definitions Area to code as many unique, solid, green triangles as they can in 2 minutes.

Walk around the room and give positive feedback on the green triangles.  After the time is up, ask for some examples of green triangles that they wrote and copy them to the board.  Be specific and attend to precision with the @vocab{syntax} such that students can visually spot the pattern between the different lines of code.

[indented-para]
--
For example:

@show{(sexp->code '(triangle  30  "solid" "green"))}

@show{(sexp->code '(triangle  12  "solid" "green"))}

@show{(sexp->code '(triangle 500  "solid" "green"))}
--

- *Is there a pattern?*
_Yes, the code mostly stayed the same with one change each time._

- *What stayed the same?*
_The function name `triangle`, "solid", "green"._

- *What changed?*
_The size of the `triangle`, or the Number input._

[.lesson-instruction]
--
@ifpathway{algebra, ok}{

We've learned how to define *values* when we want to create a shortcut to reuse the same code over and over.

For example:
@show{(sexp->code '(define PRIZE-STAR (star 65 "solid" "pink")))}

*But to make a shortcut that _changes_ such as creating solid, green triangles of a changing size, we need to define a _function_.*
}

Suppose we want to define a shortcut @vocab{function}called `gt`. When we give it a number, it makes a solid green triangle of whatever size we give it.
--

Select a student to _act out_ `gt`. Make it clear to the class that their Name is "gt", they expect a Number, and they will produce an Image. Act out some examples before having the class add their own and record them on the board:


- You say: *gt 20!*
The student responds: _@show{(sexp->code '(triangle 20 "solid" "green"))}!_
- You say: *gt 200!*
The student responds: _@show{(sexp->code '(triangle 200 "solid" "green"))}!_
- You say: *gt 99!*
The student responds: _@show{(sexp->code '(triangle 99 "solid" "green"))}!_

=== Investigate
[.lesson-instruction]
We need to program the computer to be as smart as our volunteer. But how do we do that? Let's look at the examples we just came up with.

@centered-image{images/examples-pyret.png, 400, align="center"}

[.lesson-instruction]
Whatever number we gave `gt` for the size of the triangle is the number our volunteer inserted into the `triangle` function.

We could define `gt` by giving it the variable `size`, instead of a number, and inserting the variable `size` into the `triangle` function, just as we did with the numbers.

@centered-image{images/gt-fun-pyret.png, 400, align="center"}

Have students turn to @printable-exercise{pages/match-examples-functions.adoc} and/or @online-exercise{https://teacher.desmos.com/activitybuilder/custom/5fc536c0e2f06d0cd3992c68, Matching Examples & Function Definitions} and match the examples provided to the corresponding function definitions.

=== Synthesize

[.lesson-instruction]
How do you define a function from a list of examples?

== Writing Contracts from Examples

=== Launch

* What does `gt` take in? _A Number_

* Why might someone think the domain for `gt` contains a Number and two Strings? _The function `gt` uses `triangle`, whose Domain is Number String String, but `gt` only needs one Number input because that's the only part that's changing._

* What does `gt` give back? _An Image. (Students may say "a triangle", follow up by asking what data type that triangle will be...Number, String, or Image?)_

* So, what's the contract for the function `gt`?

[.indentedpara]
--
`gt {two-colons} Number -> Image`
--

=== Investigate
Have students turn to @printable-exercise{pages/create-contracts-examples1.adoc} and/or @ifproglang{wescheme}{
* @opt-online-exercise{https://teacher.desmos.com/activitybuilder/custom/607b618988b17d447fe159e8, FIX & publish THIS before it goes live}
}
@ifproglang{pyret}{
* @opt-online-exercise{https://teacher.desmos.com/activitybuilder/custom/5fc9328d18307e2e492ca0d8, Matching Examples & Contracts}
} and practice writing contracts for examples.

=== Synthesize


== The Design Recipe

=== Overview

=== Launch

Have students turn to @printable-exercise{pages/design-recipe-1.adoc} and read the contract, examples and function definition for `gt` and type them into the Definitions Area (Contract, Examples and Definition!), click *Run* and evaluate @show{(sexp->code '(gt 10))} in the Interactions Area.

[.lesson-instruction]
 What did you get back? _a little green triangle!_

=== Investigate
[.lesson-instruction]
--
Try changing one of the examples to be incorrect +
 _An incorrect example could be_ @ifproglang{pyret}{`gt(10) is triangle(99, "solid", "green")`} @ifproglang{wescheme}{`(EXAMPLE (gt 10) (triangle(99, "solid", "green")))`} +
and click run again. What happens? +
_The editor lets us know that the function doesn't match the examples so that we can fix our mistake!_
--

Now that students know how to use the @vocab{Design Recipe} have them turn to the bottom of @printable-exercise{pages/design-recipe-1.adoc} and @printable-exercise{pages/design-recipe-2.adoc} and define `bc`, `dot` and `sticker`.

For each problem, have them type in the Contract, Purpose Statement, Examples and Definition into the Definitions Area, click “Run”, and make sure all of their examples pass!

[.strategy-box, cols="1", grid="none", stripes="none"]
|===
|@span{.title}{Connecting to Best Practices}

- Writing the examples is like "showing your work" in math class.

- Have students circle what is changing and label it with a proper variable name.  The name of the variable should reflect what it represents, such as `size`.

- Writing examples and identifying the variables lays the groundwork for writing the function, which is especially important as the functions get more complex.  Don't skip this step!
|===

=== Synthesize

- *Functions can consume values besides Numbers. What did sticker consume?*
- *Why is defining functions useful to us as programmers?*

The Design Recipe is a powerful tool for solving word problems. In this lesson, students practiced using it on simple _programming problems_, but soon they'll be applying it to traditional math problems. Encourage them to make this connection on their own: can they think of a math problem in which this would be useful?

== Additional Exercises:

* @opt-printable-exercise{pages/create-contracts-examples2.adoc}
@ifproglang{wescheme}{
* @online-exercise{https://teacher.desmos.com/activitybuilder/custom/5cdcaea0b4b8576069fdca4f, Review: Define Values & Fast Functions}
* @opt-online-exercise{https://www.wescheme.org/openEditor?publicId=JCTcwYc57r, "Bug Hunting in WeScheme"}
}
@ifproglang{pyret}{
* @opt-online-exercise{https://code.pyret.org/editor#share=1SFVHGrmn5byiJOC0sDunO2oz5fF7aQsW, "Bug Hunting in Pyret"}
}
@ifpathway{data-science}{@printable-exercise{pages/design-recipe-3.adoc}
}

=== other fragments that might be useful...

[.lesson-instruction]
--
- Design a problem for a function that takes in one input and returns a shape that uses that input. Your
function's input could be a Number, as in the two examples, or a String.
- Write two examples and a definition for your function
--

Other options include:
*Word Problem: Write a function called `gold-star` that takes in a number and produces a solid, gold star of that given size.*
Write 2 examples and the definition of `gold-star` on the 'Fast Functions' handout.


To build our own functions, we’ll use a series of steps called the @vocab{Design Recipe}. The Design Recipe is a way to think through the behavior of a function, to make sure we don’t make any mistakes! The Design Recipe has three steps, and we’ll go through them together for our first function.
