= Defining Functions

@lesson-description{Students discover functions as an abstraction over a programming pattern, and are introduced to a structured approach to building them called the Design Recipe.}

[@lesson-intro-table]
|===
@prereqs-stds{alg-defining-values}

| Lesson Goals
| Students will be able to:

* describe the usefulness of @vocab{functions}.
* create their own functions and @vocab{examples} given the constraints of a problem.
* define one-argument functions that consume a Number and produce an Image
* define one-argument functions that consume a String and produce an Image
* define one-argument functions that consume a Row and produce an Image


| Student-Facing Lesson Goals
|
* I can explain why a function is useful.
* I can write my own function in @ifproglang{wescheme}{WeScheme} @ifproglang{pyret}{Pyret}.

| Materials
|[.materials-links]

@ifproglang{wescheme}{
* @link{https://docs.google.com/presentation/d/11MWx9P1NZDRrZHh5y3CDRflLOX0nLgeilrpvih4eJFg/, Lesson Slides}
}
@ifproglang{pyret}{
* @link{https://docs.google.com/presentation/d/1UzwpEWzq01UDedMAyNhgFKaQ3_z96CB9iLIWQUt7BzI/, Lesson Slides}
}

@material-links

| Preparation
|
* Make sure all materials have been gathered
* Decide how students will be grouped in pairs


| Key Points for the Facilitator
|
* This lesson represents a big shift in thinking.  After some practice, students will not be limited to pre-existing functions!
* Take plenty of time for the @vocab{Design Recipe} as students will return to it frequently in future lessons.

@lang-prereq

|===

[.old-materials]
Click here to see the @link{https://www.bootstrapworld.org/materials/spring2020/courses/algebra/en-us/units/unit4/index.html, prior unit-based version}

== Identifying Repeated _Patterns_ @duration{30 minutes}

=== Overview
Students have already searched for structure in a list of expressions in order to define values. Now, they'll search for structures that are _dynamic_, meaning they change in a predictable way. This is the foundation for defining functions.

=== Launch

Students should have their workbook, pencil, and be logged into
@ifproglang{wescheme}{ @link{https://www.wescheme.org, WeScheme     } }
@ifproglang{pyret}{    @link{https://code.pyret.org, code.pyret.org } }
on their computer.

@centered-image{images/ILoveGreenTriangles.jpg, I Love Green Triangles, 400, align="center"}

@centered-image{images/GreenTriangle.jpg, I Love Green Triangles, 400, align="center"}

Confess to your students, "I LOVE green triangles." Challenge them to use the Definitions area to make as many DIFFERENT solid green triangles as they can in 2 minutes.

Walk around the room and give positive feedback on the green triangles.  After the 2 minutes, ask for some examples of green triangles that they wrote and copy them to the board.  Be specific and attend to precision with the @vocab{syntax} such that students can visually spot the pattern between the different lines of code.

For example:
@ifproglang{wescheme}{
```
(triangle 30  "solid" "green")
(triangle 12  "solid" "green")
(triangle 500 "solid" "green")
```
}

@ifproglang{pyret}{
```
triangle(30,  "solid", "green")
triangle(12,  "solid", "green")
triangle(500, "solid", "green")
```
}

[.notice-box, cols="1", grid="none", stripes="none"]
|===
|
@span{.title}{Notice and Wonder}

Direct students to the various lines of code they came up with.
What do you notice?  What do you wonder?

|===

- *Is there a pattern?*
_Yes, the code mostly stayed the same with one change each time._

- *What stayed the same?*
_The function name `triangle`, "solid", "green"._

- *What changed?*
_The number being given to `triangle`, or the Number input._

- *What strategy did you use to create many different triangles?*
_Answers vary: Pattern matching, copy and paste_

- *What shortcut did we use before when we wanted to use the same code over and over?* +
_We defined values in the Definitions area._

We've learned how to define *values* when we want to create a shortcut to reuse the same code over and over.

For example:
@show{(sexp->code '(define PRIZE-STAR (star 65 "solid" "pink")))}

*But to make a shortcut that _changes_ such as creating solid, green triangles of a changing size, we need to define a _function_.*

Suppose we want to define a shortcut called `gt`. When we give it a number, it makes a solid green triangle of whatever size we gave it.

Select a student to _act out_ `gt`. Make it clear to the class that their Name is "gt", they expect a Number, and they will produce an Image. Run through some sample examples before having the class add their own:

@ifproglang{wescheme}{
- You say: *gt 20!*
The student responds: _(triangle 20 "solid" "green")!_
- You say: *gt 200!*
The student responds: _(triangle 200 "solid" "green")!_
- You say: *gt 99!*
The student responds: _(triangle 99 "solid" "green")!_
}

@ifproglang{pyret}{
- You say: *gt 20!*
The student responds: _triangle(20, "solid", "green")!_
- You say: *gt 200!*
The student responds: _triangle(200, "solid", "green")!_
- You say: *gt 99!*
The student responds: _triangle(99, "solid", "green")!_
}

We need to program the computer to be as smart as our volunteer. But how do we do that?

WE NEED TO CHOOSE IF WE WANT TO SHOW THIS AS 3 STEPS OR 4 STEPS

[.lesson-instruction]
To build our own functions, we’ll use a series of steps called the @vocab{Design Recipe}. The Design Recipe is a way to think through the behavior of a function. The Design Recipe has four steps, and we’ll go through them together to define our first function `gt`. Turn to @printable-exercise{pages/FastFunctions.adoc} to follow along.

[.lesson-point]
Word Problem: Write a function called `gt` that takes in a Number and produces a solid, green triangle of that given size.

*1. Write the _contract_ for this new function by looking at the word problem.*

* What does `gt` take in? _A Number_
* What does `gt` give back? _An Image._

[.indentedpara]
--
(Students may say "a triangle", follow up by asking what data type that triangle will be (Number, String, or Image)
--

* So now, we've got our contract for the function!

[.indentedpara]
--
`gt {two-colons} Number -> Image`
--
*2. Write some examples of how this function should work.*

- If I typed @show{(sexp->code '(gt 20))}, what would I want the program to do? +
_I'd want the computer the execute the code_ @show{(sexp->code '(triangle 20 "solid" "green"))}.

[.indentedpara]
--
(This is a tough question at first.  If students are unsure, remind them that we're just writing a shortcut for making green triangles so we don't have to type `triangle`, "solid", and "green" every time!)
--

*3. Circle what is "change-able" - or _variable_ between the examples and label it with a name that describes it.* +
_The number is changing in each example.  We could name it "x", but "size" is a more accurate name._ +

@ifproglang{wescheme}{
@centered-image{images/WhatChanges-WeScheme.png, Circle and label what is changing, 400}
}
@ifproglang{pyret}{
@centered-image{images/WhatChanges-Pyret.png, Circle and label what is changing, 400}
}

*4. Write the function definition.* +

@ifproglang{wescheme}{__Look at the two examples.  The function definition will follow the same pattern, but it will use the variable name `size` in place of the variable part we circled. If it doesn't change between the examples, we just copy it.__ }
@ifproglang{pyret}{__Look at the two examples.  The function definition will follow the same pattern, but it will use the variable name `size` in place of the variable part we circled. We also use the keyword `fun`, replace the colon (`is`) with a colon (`:`), and finish it off with an `end`.__ }

@ifproglang{wescheme}{
 (define (gt size) (triangle size, "solid", "green"))
}
@ifproglang{pyret}{
 fun gt(size): triangle(size, "solid", "green") end
}

[.strategy-box, cols="1", grid="none", stripes="none"]
|===
|@span{.title}{Connecting to Best Practices}

- Writing the examples is like "showing your work" in math class.

- Have students circle what is changing and label it with a proper variable name.  The name of the variable should reflect what it represents, such as `size`.

- Writing examples and identifying the variables lays the groundwork for writing the function, which is especially important as the functions get more complex.  Don't skip this step!
|===



To build our own functions, we’ll use a series of steps called the @vocab{Design Recipe}. The Design Recipe is a way to think through the behavior of a function, to make sure we don’t make any mistakes! The Design Recipe has three steps, and we’ll go through them together for our first function.

[.lesson-instruction]
Turn to @printable-exercise{pages/design-recipe-1.adoc} in your Student Workbook, and read the word problem at the top of the page.

[.lesson-point]
Step 1: Contract and Purpose

The first thing we do is write a Contract for this function. You already know a lot about contracts: they tell us the Name, Domain and Range of the function. Our function is named `gt`, and it consumes a Number. It makes triangles, so the output will be an Image. A Purpose Statement is just a description of what the function does:

----
# gt :: (size :: Number) -> Image
# Consumes a size, and produces a solid green triangle of that size.
----

Since the contract and purpose statement are notes for humans, we add the # symbol at the front of the line to turn them into comments.

Be sure to check students’ contracts and purpose statements before having them move on!

[.lesson-point]
Step 2: Write Examples

Examples are a way for us to tell the computer how our function should behave for a specific input. We can write as many examples as we want, but they must all be wrapped in an examples: block and an end statement. Examples start with the name of the function we’re writing, followed by an example input. Suppose we write `gt(10)`. What work do we have to do, in order to produce the right shape as a result? What if we write `gt(20)`?

----
# gt :: (size :: Number) -> Image
# Consumes a size, and produces a solid green triangle of that size.
examples:
  gt(100) is triangle(100, "solid", "green")
  gt(30)  is triangle(30, "solid", "green")
end
----

[.lesson-point]
Step 3: Define the Function

We start with the `fun` keyword (short for “function”), followed by the name of our function and a set of parentheses. This is exactly how all of our examples started, too. But instead of writing `10` or `20`, we’ll use the label from our Domain. Then we add a colon (`:`) in place of `is`, and write out the work we did to get the answers for our examples. Finally, we finish with the `end` keyword.

----
# gt :: (size :: Number) -> Image
# Consumes a size, and produces a solid green triangle of that size.
examples:
  gt(100) is triangle(100, "solid", "green")
  gt(30)  is triangle(30, "solid", "green")
end
fun gt(size):
  triangle(size, "solid", "green")
end
----

=== Investigate

Have students type the function definition for `gt` into the Definitions Area. Be sure to include the Contract, Purpose Statement, Examples _and_ your Definition! Once you have typed everything in, click "Run" and evaluate @show{(sexp->code '(gt 10))} in the Interactions Area.

[.lesson-instruction]
--
- What did you get back? _a little green triangle!_
- Try changing one of the examples to be incorrect and click run again. What happens? +
_An incorrect example could be @ifproglang{pyret}{`gt(10) is triangle(99, "solid", "green")`} @ifproglang{wescheme}{`(EXAMPLE (gt 10) (triangle(99, "solid", "green")))`}_ +

_The editor lets us know that the function doesn't match the examples so that we can fix our mistake!_
--

Now that students know how to use the @vocab{Design Recipe} have them turn to the bottom of @printable-exercise{pages/FastFunctions.adoc} (or @printable-exercise{pages/design-recipe-1.adoc} and @printable-exercise{pages/design-recipe-2.adoc}) and define `bc`, `dot` and `sticker`.

	Other options include:
	*Word Problem: Write a function called `gold-star` that takes in a number and produces a solid, gold star of that given size.*
	Write 2 examples and the definition of `gold-star` on the 'Fast Functions' handout.

For each problem, have them type in the Contract, Purpose Statement, Examples and Definition into the Definitions Area, click “Run”, and make sure all of their examples pass!

=== Synthesize
- *What is the domain for `gt`?*
_Number_

- *Why might someone think the domain for `gt` contains a Number and two Strings?* The function `gt` _uses_ `triangle`, whose Domain is Number String String, but `gt` only needs one Number input because _that's the only part that's changing._
- *Functions can consume values besides Numbers. What did sticker consume?*
- *Why is defining functions useful to us as programmers?*

The Design Recipe is a powerful tool for solving word problems. In this lesson, students practiced using it on simple _programming problems_, but soon they'll be applying it to traditional math problems. Encourage them to make this connection on their own: can they think of a math problem in which this would be useful?

IS THERE A REASON TO SAVE THIS FOR THE FUTURE? SEEMS WE COULD MAKE THAT CONNECTION HERE! THERE IS ONE DR PROBLEM FOR THAT IN @printable-exercise{pages/design-recipe-3.adoc}.} WHICH IS CURRENTLY ONLY USABLE FOR DATA SCIENCE BUT COULD BE MODIFIED

== Additional Exercises: I FEEL TEMPTED TO MAKE A SECOND SECTION OF THIS LESSON PLAN TO ENGAGE PEOPLE WITH THESE

@ifproglang{wescheme}{
* @online-exercise{https://teacher.desmos.com/activitybuilder/custom/5cdcaea0b4b8576069fdca4f, Review: Define Values & Fast Functions}
* @opt-online-exercise{https://www.wescheme.org/openEditor?publicId=JCTcwYc57r, "Bug Hunting in WeScheme"}
}
* @opt-online-exercise{https://teacher.desmos.com/activitybuilder/custom/607b618988b17d447fe159e8, FIX & publish THIS before it goes live}

@ifproglang{pyret}{
* @opt-online-exercise{https://teacher.desmos.com/activitybuilder/custom/5fc9328d18307e2e492ca0d8, Matching Examples & Contracts}
* @opt-online-exercise{https://teacher.desmos.com/activitybuilder/custom/5fc536c0e2f06d0cd3992c68, Matching Examples & Function Definitions}
* @opt-online-exercise{https://code.pyret.org/editor#share=1SFVHGrmn5byiJOC0sDunO2oz5fF7aQsW, "Bug Hunting in Pyret"}
}

* @printable-exercise{pages/match-examples-functions.adoc}

* @opt-printable-exercise{pages/create-contracts-examples1.adoc}

* @opt-printable-exercise{pages/create-contracts-examples2.adoc}

=== other fragments that might be useful...

[.lesson-instruction]
--
- Design a problem for a function that takes in one input and returns a shape that uses that input. Your
function's input could be a Number, as in the two examples, or a String.
- Write two examples and a definition for your function
--

